<div class="row">
    <div class="card-deck mx-1">
        <% posts.each do |post| %>
        <div class="col-md-6 col-lg-4 col-xl-3 mb-5 px-0">
            <div class="card h-100">
                <%= image_tag post.image,class: "img-fluid" %>
                <div class="card-body px-3 pb-3 pt-0">
                    <div class="row mb-3">
                        <div class="col-6">
                            <% if post.favorited_by?(current_user) %>
                                <p>
                                    <%= link_to post_public_favorites_path(post),method: :delete do %>
                                        ♥<%= post.favorites.count %>件
                                    <% end %>
                                </p>
                            <% else %>
                                <p>
                                    <%= link_to post_public_favorites_path(post),method: :post do %>
                                        ♡<%= post.favorites.count %>件
                                    <% end %>
                                </p>
                            <% end %>
                        </div>
                        <div class="col-6 text-right">
                            <%= link_to mypage_path(post.user.id) do %>
                                ＠<%= post.user.user_name %>
                            <% end %>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-6 pr-0">
                            <span class="card-title h4 font-weight-bold"><%= post.title %></span>    
                        </div>
                        <div class="col-6 text-right pl-0">
                            <span class="h6 align-bottom d-sm-none">おすすめ度：</span>
                            <!--星型レビューを表示-->
                            <span id="rate_<%= post.id %>"></span>
                            <script>
                            $(document).on('turbolinks:load', function() {
                                let raty_<%= post.id %> = document.querySelector('#rate_<%= post.id %>');
                                rate_<%= post.id %>.innerHTML = ""
                                let option_<%= post.id %> = {
                                    starOn: "<%= asset_path('star-on.png') %>",
                                    starOff: "<%= asset_path('star-off.png') %>",
                                    score: "<%= post.star %>",
                                    readOnly: true,
                                  };
                                raty(raty_<%= post.id %> ,option_<%= post.id %>);
                            });
                            </script>
                            <!---------------------->
                        </div>
                    </div>
                    <p class="card-text"><%= post.body %></p>
                    <small class="text-muted">市町村：<%= post.town.town_name %>　カテゴリ：<%= post.category.category_name %></small>
                </div>
            </div>
        </div>
        <% end %>
    </div>
</div>